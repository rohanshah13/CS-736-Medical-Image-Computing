phantom = imread('../data/ChestPhantom.png');
phantom = mat2gray(phantom);
theta = 0:1:179;

tic
rng(0);
 A = system_mat(128, theta);
 A = sparse(A);
b = A*reshape(phantom,[],1);
noisy_b = b + 0.02*range(b)*randn(length(A),1);
phantom = reshape(phantom,[],1);
tikh = tikhonov(A,noisy_b,12);
toc

%%
%
%init-zeros, step-0.01

%tikhonov
%12 0.1462 <---
%9.6 0.1493
%14.4 0.1553

%% option 2
%t_opt
%64 0.0672 0.1104
%72.8 0.084 0.1100
% 0.1008 0.1112
%80 0.084 0.1056
%144 0.084 0.1007
% 173 0.084 0.1002
% 138.4 0.084 0.1001
% 110.72 0.084 0.1010
% 166.08 0.0448 0.0923 
% 166.08 0.07 0.0969 
% 138.4 0.07 0.0971 
% 138.4 0.056 0.0953
% 138 0.0448 0.0961
% 200 0.036 0.0905
% 240 0.036
% 290 0.036 0.0887
% 350 0.02 0.0861
% 350 0.024 0.0867
% 350 0.016 0.0884

%%% final values
% 420 0.02 0.0846 <----------
% 420 0.016 0.0860
% 420 0.024 0.0864
% 504 0.02 0.0863
% 336 0.02 0.0867


%% option 3
% 500 0.015 0.0917
% 500 0.01 0.0977
% 450 0.015 0.0936
% 550 0.015 0.0904 
% 550 0.01 0.0949
% 600 0.015 0.0893 
% 650 0.015 0.0888
% 680 0.015 0.0885 
% 700 0.015 0.0884 <---------
% 700 0.018 0.0895 
% 700 0.012 0.0883
% 560 0.015 0.0901
% 840 0.015 0.0885